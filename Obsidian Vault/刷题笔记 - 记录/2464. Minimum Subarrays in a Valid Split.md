
#gcd #array

```python

import math

class Solution:
    def validSubarraySplit(self, nums: List[int]) -> int:
        n = len(nums)
        
        # dp[i] = minimum number of valid subarrays needed 
        # to split the prefix nums[:i] (i elements)
        dp = [float('inf')] * (n + 1)
        
        # Base case: no elements → 0 subarrays
        dp[0] = 0

        # Iterate through the array (1-based index for dp)
        for i in range(1, n + 1):
            # Try to end the current subarray at position i-1
            # and find a valid start position j-1
            for j in range(1, i + 1):
                # Check if the subarray [j-1, i-1] can be validly connected
                # The condition: gcd(nums[i-1], nums[j-1]) > 1
                # means these two endpoints share a common factor > 1,
                # so this can be part of a valid split
                if math.gcd(nums[i - 1], nums[j - 1]) > 1:
                    # Update the minimum subarray count
                    dp[i] = min(dp[i], dp[j - 1] + 1)

        # If dp[n] is still infinity, it means no valid split exists
        return -1 if dp[n] == float('inf') else dp[n]

```

- Complexity: O(n² log M) time, O(n) space.