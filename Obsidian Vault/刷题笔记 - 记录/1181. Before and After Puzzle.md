| Category   | Difficulty       | Likes | Dislikes |
| ---------- | ---------------- | ----- | -------- |
| algorithms | #Medium (46.58%) | 90    | 157      |

**Tags**

[`Unknown`](https://leetcode.com/tag/Unknown?source=vscode "https://leetcode.com/tag/Unknown?source=vscode") #array #hash-table #string #sorting

**Companies**

`Unknown`

Given a list of `phrases`, generate a list of Before and After puzzles.

A _phrase_ is a string that consists of lowercase English letters and spaces only. No space appears in the start or the end of a phrase. There are no consecutive spaces in a phrase.

_Before and After puzzles_ are phrases that are formed by merging two phrases where the **last word of the first phrase** is the same as the **first word of the second phrase**.

Return the Before and After puzzles that can be formed by every two phrases `phrases[i]` and `phrases[j]` where `i != j`. Note that the order of matching two phrases matters, we want to consider both orders.

You should return a list of **distinct** strings **sorted lexicographically**.

**Example 1:**

```
Input: phrases = ["writing code","code rocks"]
Output: ["writing code rocks"]
```

**Example 2:**

```
Input: phrases = ["mission statement",
                  "a quick bite to eat",
                  "a chip off the old block",
                  "chocolate bar",
                  "mission impossible",
                  "a man on a mission",
                  "block party",
                  "eat my words",
                  "bar of soap"]
Output: ["a chip off the old block party",
         "a man on a mission impossible",
         "a man on a mission statement",
         "a quick bite to eat my words",
         "chocolate bar of soap"]
```

**Example 3:**

```
Input: phrases = ["a","b","a"]
Output: ["a"]
```

**Constraints:**

- `1 <= phrases.length <= 100`
- `1 <= phrases[i].length <= 100`

---

[Submissions](https://leetcode.com/problems/before-and-after-puzzle/submissions/?source=vscode "https://leetcode.com/problems/before-and-after-puzzle/submissions/?source=vscode") | [Solution](https://leetcode.com/problems/before-and-after-puzzle/solutions/?source=vscode "https://leetcode.com/problems/before-and-after-puzzle/solutions/?source=vscode")

```python

class Solution:
    def beforeAndAfterPuzzles(self, phrases: List[str]) -> List[str]:
        n = len(phrases)
        sp = []
        for phrase in phrases:
            words = phrase.split(" ")
            sp.append((words[0], words[-1]))

        m = set()
        for i in range(n):
            for j in range(n):
                if i == j:
                    continue
                if sp[i][0] == sp[j][1]:
                    combined = phrases[j] + phrases[i][len(sp[i][0]) :]
                    m.add(combined)

        ret = sorted(list(m))
        return ret

```

#### Complexity Analysis

Let N be the length of the string array `phrases`, and K be the average length of the string phrases.

- Time complexity: O(N2K(logN+logK))
    
    The double traversal of the array costs O(N2K). The hash table can store up to N(N−1) concatenated phrases, where the maximum length of each phrase is 2K−C, with C being the length of the overlapping word. Sorting these strings takes O(N(N−1)(2K−C)(log(N(N−1))+log(2K−C))), which simplifies to O(N2K(logN+logK)).
    
- Space complexity: O(N2K)
    
    The hash table can store up to N(N−1) entries, each occupying O(K) space. In addition, the two-dimensional array `sp` has a maximum size proportional to the input array `phrases`.